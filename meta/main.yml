---
galaxy_info:
  author: Ona Engineering
  description: This role is used to install and configure Enketo
  min_ansible_version: 2.4
  license: Apache 2
  platforms:
    - name: Ubuntu
      verions:
      - xenial
      - trusty
  categories:
    - enketo

dependencies:
 - role: DavidWittman.redis
   become: true
   become_user: "root"
   redis_bind: "{{ enketo_redis_bind_address }}"
   tags:
    - redis

 - role: nginx
   become: true
   become_user: "root"
   nginx_sites: "{{ enketo_nginx_sites }}"
   nginx_install_method: "package"
   nginx_enabled_sites:
    - "{{ enketo_nginx_http_site_name }}"
    - "{{ enketo_nginx_https_site_name }}"
   nginx_default_enable: false
   tags:
    - nginx

 - role: collectd
   become: true
   become_user: "root"
   collectd_scripts: ["nginx"]
   collectd_deployed_app_name: "enketo"
   collectd_deployed_app_version: "{{ enketo_git_branch }}"
   tags:
    - collectd

 - role: mrlesmithjr.logstash
   become: true
   become_user: "root"
   openjdk_version: "{{ enketo_openjdk_version }}"
   tags:
    - logstash

 - role: Stouts.backup
   become: true
   become_user: "root"
   backup_enabled: "{{ enketo_redis_backup_enabled }}"
   backup_profiles: "{{ enketo_backup_profiles }}"
   backup_max_age: "{{ enketo_backup_max_age }}"
   backup_full_max_age: "{{ enketo_backup_full_max_age }}"
   backup_target_user: "{{ enketo_backup_target_user }}"
   backup_target_pass: "{{ enketo_backup_target_pass }}"
   tags:
    - backup
